<app-header></app-header>

<div class="container mx-auto py-8 bg-white font-sans mt-2 card animate-fade-in">
  <!-- Header -->
  <header class="mb-8 text-center bg-gradient-to-r from-green-50 to-blue-50 mx-6 py-6 rounded-lg">
    <div class="flex items-center justify-center space-x-4">
      <div class="w-12 h-12 bg-gradient-to-r from-green-600 to-blue-600 rounded-full flex items-center justify-center">
        <i class="bi bi-receipt text-white text-lg"></i>
      </div>
      <div>
        <h1 class="heading-1 text-gray-800 mb-0">Order Summary</h1>
        <p class="text-gray-600 text-sm">Review your order details before payment</p>
      </div>
    </div>
  </header>

  <div class="flex flex-col lg:flex-row gap-8 items-start">

    <!-- Order Details Section -->
    <section class="lg:w-2/3">
      <div class="card mb-6">
        <div class="card-header">
          <div class="flex items-center space-x-3">
            <i class="bi bi-bag-check text-blue-600 text-lg"></i>
            <h2 class="heading-3 mb-0">Order Details</h2>
          </div>
        </div>
        <div class="card-body space-y-4">
          @for (item of orderDetails; track item.id) {
            <div class="flex items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors animate-slide-in">
              <div class="relative">
                <img [src]="item.imageUrl" alt="{{ item.name }}" class="w-20 h-20 object-cover rounded-lg shadow-md">
                <div class="absolute -top-2 -right-2 bg-blue-600 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center font-bold">
                  {{ item.quantity }}
                </div>
              </div>
              <div class="flex-1 ml-4">
                <h5 class="font-bold text-lg text-gray-800 mb-1">{{ item.name }}</h5>
                <p class="text-sm text-gray-600 mb-2">Quantity: {{ item.quantity }} items</p>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600 text-sm">₹{{ item.price }} each</span>
                  <span class="font-bold text-blue-600 text-lg">₹{{ item.price * (item.quantity ?? 1) }}</span>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    </section>

    <!-- User Details Section -->
    <aside class="lg:w-1/3">
      <div class="card sticky top-24 animate-slide-in">
        <div class="card-header">
          <div class="flex items-center space-x-3">
            <i class="bi bi-person-circle text-blue-600 text-lg"></i>
            <h2 class="heading-3 mb-0">Customer Details</h2>
          </div>
        </div>
        <div class="card-body">

          <form #detailsForm="ngForm" class="space-y-6">
            <!-- Full Name -->
            <div class="form-group">
              <label for="name" class="form-label flex items-center">
                <i class="bi bi-person mr-2 text-blue-600"></i>
                Full Name
              </label>
              <input
                type="text"
                id="name"
                name="name"
                [(ngModel)]="customerName"
                required
                pattern="[A-Za-z\s]+"
                #nameCtrl="ngModel"
                class="form-input"
                [class.error]="nameCtrl.invalid && (nameCtrl.dirty || nameCtrl.touched)"
                placeholder="Enter your full name"
              />
              @if (nameCtrl.invalid && (nameCtrl.dirty || nameCtrl.touched)) {
                <div class="form-error">
                  @if (nameCtrl.errors?.['required']) {
                    <div><i class="bi bi-exclamation-circle mr-1"></i>Name is required.</div>
                  }
                  @if (nameCtrl.errors?.['pattern']) {
                    <div><i class="bi bi-exclamation-circle mr-1"></i>Name must not contain special characters or numbers.</div>
                  }
                </div>
              }
            </div>

            <!-- Phone Number -->
            <div class="form-group">
              <label for="contact" class="form-label flex items-center">
                <i class="bi bi-telephone mr-2 text-blue-600"></i>
                Phone Number
              </label>
              <input
                type="text"
                id="contact"
                name="contact"
                [(ngModel)]="contactInfo"
                required
                pattern="[0-9]{10}"
                #contactCtrl="ngModel"
                class="form-input"
                [class.error]="contactCtrl.invalid && (contactCtrl.dirty || contactCtrl.touched)"
                placeholder="Enter 10-digit phone number"
              />
              @if (contactCtrl.invalid && (contactCtrl.dirty || contactCtrl.touched)) {
                <div class="form-error">
                  @if (contactCtrl.errors?.['required']) {
                    <div><i class="bi bi-exclamation-circle mr-1"></i>Phone number is required.</div>
                  }
                  @if (contactCtrl.errors?.['pattern']) {
                    <div><i class="bi bi-exclamation-circle mr-1"></i>Phone number must be exactly 10 digits.</div>
                  }
                </div>
              }
            </div>

            <!-- Shipping Address -->
            <div class="form-group">
              <label for="address" class="form-label flex items-center">
                <i class="bi bi-geo-alt mr-2 text-blue-600"></i>
                Shipping Address
              </label>
              <textarea
                id="address"
                name="address"
                [(ngModel)]="shippingAddress"
                required
                #addressCtrl="ngModel"
                class="form-input min-h-[100px] resize-none"
                [class.error]="addressCtrl.invalid && (addressCtrl.dirty || addressCtrl.touched)"
                placeholder="Enter your complete shipping address"
              ></textarea>
              @if (addressCtrl.invalid && (addressCtrl.dirty || addressCtrl.touched)) {
                <div class="form-error">
                  @if (addressCtrl.errors?.['required']) {
                    <div><i class="bi bi-exclamation-circle mr-1"></i>Shipping address is required.</div>
                  }
                </div>
              }
            </div>
          </form>

          <!-- Order Total -->
          <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-4 mt-6">
            <div class="flex justify-between items-center">
              <div class="flex items-center space-x-2">
                <i class="bi bi-calculator text-blue-600"></i>
                <span class="font-bold text-gray-800">ORDER TOTAL</span>
              </div>
              <span class="font-bold text-2xl text-blue-600">₹{{ totalAmount.toFixed(2) }}</span>
            </div>
            <div class="text-center mt-2">
              <p class="text-gray-600 text-sm">Includes all taxes and shipping</p>
            </div>
          </div>

          <!-- Proceed Button -->
          <div class="mt-6 space-y-3">
            <button
              (click)="proceedToPay(detailsForm)"
              [disabled]="detailsForm.invalid"
              class="btn btn-success w-full py-4 text-lg hover-lift"
              [class.opacity-50]="detailsForm.invalid"
              [class.cursor-not-allowed]="detailsForm.invalid"
            >
              <i class="bi bi-credit-card mr-2"></i>
              Proceed to Payment
            </button>
            <div class="text-center">
              <div class="flex items-center justify-center space-x-2 text-gray-500 text-sm">
                <i class="bi bi-shield-check text-green-600"></i>
                <span>Secure & encrypted payment</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>
  </div>
</div>

<app-footer></app-footer>
