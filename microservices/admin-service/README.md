# Admin Service

A comprehensive admin microservice for the MyStore E-commerce platform, built with Spring Boot following best practices.

## Features

### Authentication & Authorization
- Admin login/logout
- Password change functionality
- Role-based access (ADMIN, SUPERADMIN)
- JWT token-based authentication

### Admin Management
- Create, read, update, delete admin users
- Search and filter admins
- Admin status management (ACTIVE, INACTIVE, SUSPENDED)
- Role management

### Product Management (via Product Service)
- View all products with pagination
- Create, update, delete products
- Search products by name, category, brand
- Stock management
- Low stock alerts
- Category and brand management

### Order Management (via Order Service)
- View all orders with pagination
- Update order status
- Order search and filtering
- Quick actions (confirm, process, ship, deliver, cancel)
- Order statistics and analytics

### Dashboard & Analytics
- Overview dashboard with key metrics
- Daily order statistics
- Revenue tracking
- Service health monitoring
- Alert system for low stock and pending orders

## Architecture

### Technology Stack
- **Framework**: Spring Boot 3.2.0
- **Database**: H2 (in-memory)
- **Security**: Spring Security with BCrypt
- **Service Discovery**: Eureka Client
- **Inter-service Communication**: OpenFeign
- **Validation**: Bean Validation (JSR-303)
- **Build Tool**: Maven

### Design Patterns
- **Repository Pattern**: Data access layer
- **Service Layer Pattern**: Business logic separation
- **DTO Pattern**: Data transfer objects
- **Circuit Breaker Pattern**: Fallback mechanisms for external services

## API Endpoints

### Authentication
- `POST /api/admin/auth/login` - Admin login
- `POST /api/admin/auth/logout` - Admin logout
- `GET /api/admin/auth/profile/{username}` - Get admin profile
- `PUT /api/admin/auth/change-password/{adminId}` - Change password

### Admin Management
- `GET /api/admin/management/admins` - Get all admins (paginated)
- `GET /api/admin/management/admins/{id}` - Get admin by ID
- `POST /api/admin/management/admins` - Create new admin
- `PUT /api/admin/management/admins/{id}` - Update admin
- `DELETE /api/admin/management/admins/{id}` - Delete admin
- `GET /api/admin/management/admins/search` - Search admins
- `GET /api/admin/management/stats` - Admin statistics

### Product Management
- `GET /api/admin/products` - Get all products (paginated)
- `GET /api/admin/products/{id}` - Get product by ID
- `POST /api/admin/products` - Create product
- `PUT /api/admin/products/{id}` - Update product
- `DELETE /api/admin/products/{id}` - Delete product
- `GET /api/admin/products/search` - Search products
- `PUT /api/admin/products/{id}/stock` - Update stock
- `GET /api/admin/products/low-stock` - Get low stock products

### Order Management
- `GET /api/admin/orders` - Get all orders (paginated)
- `GET /api/admin/orders/{id}` - Get order by ID
- `PUT /api/admin/orders/{id}/status` - Update order status
- `GET /api/admin/orders/search` - Search orders
- `PUT /api/admin/orders/{id}/confirm` - Confirm order
- `PUT /api/admin/orders/{id}/ship` - Ship order
- `GET /api/admin/orders/stats/summary` - Order statistics

### Dashboard
- `GET /api/admin/dashboard/overview` - Dashboard overview
- `GET /api/admin/dashboard/alerts` - System alerts
- `GET /api/admin/dashboard/health` - Service health status

## Configuration

### Application Properties
```yaml
server:
  port: 8083

spring:
  application:
    name: admin-service
  datasource:
    url: jdbc:h2:mem:admindb
    username: sa
    password: password
  jpa:
    hibernate:
      ddl-auto: create-drop

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
```

### Default Admin Users
The service creates default admin users on startup:
- **Superadmin**: `superadmin/superadmin123`
- **Admin**: `admin/admin123`
- **Ajay (Superadmin)**: `ajay/ajay123`

## Running the Service

### Prerequisites
- Java 17+
- Maven 3.6+
- Eureka Server running on port 8761

### Standalone
```bash
cd microservices/admin-service
mvn spring-boot:run
```

### With All Services
```bash
# From project root
start-all.bat
```

## Service Dependencies

### Required Services
- **Eureka Server** (8761) - Service discovery
- **API Gateway** (8080) - Request routing

### Optional Services (with fallbacks)
- **Product Service** (8082) - Product operations
- **Order Service** (8084) - Order operations

## Database

### H2 Console
- URL: http://localhost:8083/h2-console
- JDBC URL: `jdbc:h2:mem:admindb`
- Username: `sa`
- Password: `password`

### Tables
- `admins` - Admin user information
- Auto-generated by JPA/Hibernate

## Security

### CORS Configuration
- Allows origins: `http://localhost:4200`, `http://localhost:3000`
- Supports all HTTP methods
- Credentials allowed

### Password Security
- BCrypt encryption
- Minimum 6 characters
- Password change functionality

## Error Handling

### Global Exception Handler
- Validation errors with field-specific messages
- Runtime exceptions with custom messages
- Generic error responses for unexpected errors

## Monitoring & Health

### Actuator Endpoints
- `/actuator/health` - Service health
- `/actuator/info` - Service information
- `/actuator/metrics` - Service metrics

### Service Status
- Product Service availability check
- Order Service availability check
- Database connectivity

## Development

### Project Structure
```
src/main/java/com/mystore/admin/
├── AdminServiceApplication.java
├── client/                 # Feign clients
├── config/                 # Configuration classes
├── controller/             # REST controllers
├── dto/                    # Data transfer objects
├── exception/              # Exception handling
├── model/                  # JPA entities
├── repository/             # Data repositories
└── service/                # Business logic
```

### Best Practices Implemented
- Clean Architecture
- SOLID principles
- Separation of concerns
- Input validation
- Error handling
- Logging
- Documentation
- Circuit breaker pattern
- Pagination support
- Search functionality

## Testing

### Unit Tests
```bash
mvn test
```

### Integration Tests
```bash
mvn verify
```

## Future Enhancements

- JWT token implementation
- Redis caching
- Audit logging
- Email notifications
- File upload for product images
- Advanced analytics
- Role-based permissions
- API rate limiting